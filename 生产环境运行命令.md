# 生产环境运行收入明细查询脚本

## 📋 查询 2025-12-02 的收入明细

脚本已更新并推送到仓库，现在可以在生产环境运行。

## 🚀 快速运行命令

### 方法1：SSH 连接后运行

```bash
# 1. SSH 连接到生产服务器
ssh user@production-server

# 2. 进入项目目录
cd /app

# 3. 拉取最新代码（如果使用 Git）
git pull origin main

# 4. 运行脚本查询 2025-12-02
export DATA_DIR=/data
python list_all_income_records.py 2025-12-02
```

### 方法2：Docker 容器运行

```bash
# 直接执行（替换容器名）
docker exec -it <container_name> bash -c "cd /app && export DATA_DIR=/data && python list_all_income_records.py 2025-12-02"

# 或进入容器后执行
docker exec -it <container_name> bash
cd /app
export DATA_DIR=/data
python list_all_income_records.py 2025-12-02
```

### 方法3：保存结果到文件

```bash
# 保存到文件
cd /app
export DATA_DIR=/data
python list_all_income_records.py 2025-12-02 > income_2025-12-02.txt

# 查看结果
cat income_2025-12-02.txt
```

## 📊 输出格式

脚本会显示：
```
序号 | 金额 | 订单号 | 时间
```

示例输出：
```
  序号              金额 |                       订单号 |         时间
------------------------------------------------------------------------------------------------------------------------
  1.         300.00 |                         无 |   14:45:19
  2.         840.00 |              2511180307 |   14:26:50
  3.         180.00 |            2512020903A |   13:13:45
```

## ✅ 完整命令（一键执行）

```bash
cd /app && export DATA_DIR=/data && python list_all_income_records.py 2025-12-02 | tee income_2025-12-02.txt
```

这个命令会：
1. 进入项目目录
2. 设置数据库路径
3. 运行脚本查询数据
4. 同时显示在终端和保存到文件

## 📝 注意事项

1. **数据库路径**：确保 `DATA_DIR` 环境变量指向正确的数据库路径（通常是 `/data`）
2. **脚本位置**：确保脚本在项目根目录 `/app` 或项目实际路径
3. **权限**：确保有读取数据库文件的权限

## 🔍 验证脚本

运行前可以验证：

```bash
# 检查脚本是否存在
ls -la list_all_income_records.py

# 检查数据库文件
ls -la /data/loan_bot.db

# 检查环境变量
echo $DATA_DIR
```

