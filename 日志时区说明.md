# 日志时区说明

## 📋 当前情况

你看到的日志时间戳：
```
2025-12-02 15:39:02,650 - httpx - INFO - HTTP Request: ...
2025-12-02 15:39:12,829 - httpx - INFO - HTTP Request: ...
```

## 🔍 日志时间说明

### 日志时间戳的来源

Python 的 `logging` 模块默认使用系统时间。如果服务器时区是 UTC，日志时间戳就是 UTC 时间。

### 是否需要修复？

**通常不需要**，因为：
1. **日志主要用于调试**：开发人员知道服务器时区
2. **不影响用户**：用户看到的是应用内显示的时间（已修复）
3. **日志一致性**：保持UTC时间便于跨时区协作

### 如果确实需要修复

如果需要日志也显示北京时间，可以配置自定义格式化器：

```python
import logging
from datetime import datetime
import pytz

class BeijingTimeFormatter(logging.Formatter):
    """使用北京时间的日志格式化器"""
    def formatTime(self, record, datefmt=None):
        tz_beijing = pytz.timezone('Asia/Shanghai')
        dt = datetime.fromtimestamp(record.created, tz_beijing)
        if datefmt:
            return dt.strftime(datefmt)
        return dt.strftime('%Y-%m-%d %H:%M:%S')

# 配置日志
handler = logging.StreamHandler()
handler.setFormatter(BeijingTimeFormatter(
    '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
))
logging.basicConfig(level=logging.INFO, handlers=[handler])
```

## ✅ 已修复的时间显示

以下时间显示已经修复为北京时间：
- ✅ **收入明细时间**：显示为北京时间
- ✅ **报表时间**：显示为北京时间
- ✅ **日期计算**：使用北京时间

## 📊 时间对照

如果你的日志显示 `15:39`（UTC时间），对应的北京时间是：
- **UTC 15:39** = **北京时间 23:39**（UTC+8）

---

**建议**：如果日志仅用于调试，可以保持UTC时间。如果希望日志也显示北京时间，我可以帮你配置。

